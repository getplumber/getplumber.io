---
title: "OpenSource CLI"
description: "Complete reference for the Plumber CLI tool"
sidebar:
  label: "OpenSource CLI"
  order: 1
section: "api"
---
import { Icon } from "astro-icon/components";

The Plumber CLI allows you to analyze GitLab CI/CD pipelines from the command line. This is useful for local testing, CI/CD integration, or automated compliance checks.

<Button variant="outline" class="!border-base-900 dark:!border-base-100 hover:!border-primary-500/90 dark:hover:!border-primary-100/90" href="https://github.com/getplumber/plumber"><Icon name="tabler/brand-github" class="mr-2" />View on GitHub</Button>

## Installation

<Tabs defaultValue="binary">
  <TabsList>
    <TabsTrigger value="binary">Binary</TabsTrigger>
    <TabsTrigger value="docker">Docker</TabsTrigger>
    <TabsTrigger value="source">Build from Source</TabsTrigger>
  </TabsList>

  <TabsContent value="binary">
    Pre-built binaries are available for each release.

    **Linux (amd64)**
    ```bash
    curl -LO https://github.com/getplumber/plumber/releases/latest/download/plumber-linux-amd64
    chmod +x plumber-linux-amd64
    sudo mv plumber-linux-amd64 /usr/local/bin/plumber
    ```

    **Linux (arm64)**
    ```bash
    curl -LO https://github.com/getplumber/plumber/releases/latest/download/plumber-linux-arm64
    chmod +x plumber-linux-arm64
    sudo mv plumber-linux-arm64 /usr/local/bin/plumber
    ```

    **macOS (Apple Silicon)**
    ```bash
    curl -LO https://github.com/getplumber/plumber/releases/latest/download/plumber-darwin-arm64
    chmod +x plumber-darwin-arm64
    sudo mv plumber-darwin-arm64 /usr/local/bin/plumber
    ```

    **macOS (Intel)**
    ```bash
    curl -LO https://github.com/getplumber/plumber/releases/latest/download/plumber-darwin-amd64
    chmod +x plumber-darwin-amd64
    sudo mv plumber-darwin-amd64 /usr/local/bin/plumber
    ```

    **Windows (PowerShell)**
    ```powershell
    Invoke-WebRequest -Uri https://github.com/getplumber/plumber/releases/latest/download/plumber-windows-amd64.exe -OutFile plumber.exe
    ```

    **Verify checksum** (optional):
    ```bash
    curl -LO https://github.com/getplumber/plumber/releases/latest/download/checksums.txt
    sha256sum -c checksums.txt --ignore-missing
    ```
  </TabsContent>

  <TabsContent value="docker">
    Pull the latest image from Docker Hub:

    ```bash
    docker pull getplumber/plumber:latest
    ```

    Run analysis directly with Docker:

    ```bash
    docker run --rm \
      -e GITLAB_TOKEN=glpat-xxxx \
      getplumber/plumber:latest analyze \
      --gitlab-url https://gitlab.com \
      --project mygroup/myproject
    ```
  </TabsContent>

  <TabsContent value="source">
    Clone the repository and build:

    ```bash
    git clone https://github.com/getplumber/plumber.git
    cd plumber
    make build
    # or: make install (builds and copies to /usr/local/bin/)
    ```

    <Aside variant="info">
      Requires Go 1.24+ and Make.
    </Aside>
  </TabsContent>
</Tabs>

## Quick Start

<Steps>
1. **Generate a config file**

   ```bash
   plumber generate config
   ```

   This creates `.plumber.yaml` with default compliance rules. You can customize it later.

2. **Create and set your GitLab token**

   In GitLab, go to **User Settings → Access Tokens** ([direct link](https://gitlab.com/-/user_settings/personal_access_tokens)) and create a Personal Access Token with `read_api` + `read_repository` scopes:

   ```bash
   export GITLAB_TOKEN=glpat-xxxx
   ```

   <Aside variant="tip">
     You can also use a project or group access token if you prefer scoped permissions.
   </Aside>

3. **Run analysis**

   ```bash
   plumber analyze \
     --gitlab-url https://gitlab.com \
     --project mygroup/myproject
   ```

4. **Review results**

   Plumber reads your `.plumber.yaml` config and outputs a compliance report. You can also tell it to store the output in JSON format with the `--output` flag.
</Steps>

## Command Reference

### `plumber analyze`

The main command for analyzing GitLab CI/CD pipelines.

```bash
plumber analyze [flags]
```

### Flags

| Flag | Required | Default | Description |
|------|----------|---------|-------------|
| `--gitlab-url` | Yes | - | GitLab instance URL (e.g., `https://gitlab.com`) |
| `--project` | Yes | - | Project path (e.g., `group/project`) |
| `--config` | No | `.plumber.yaml` | Path to configuration file |
| `--threshold` | No | `100` | Minimum compliance % to pass (0-100) |
| `--branch` | No | Project default | Branch to analyze |
| `--output` | No | - | Write JSON results to file |
| `--print` | No | `true` | Print text output to stdout |

### Environment Variables

| Variable | Required | Description |
|----------|----------|-------------|
| `GITLAB_TOKEN` | Yes | GitLab API token with `read_api` and `read_repository` scopes |

### Exit Codes

| Code | Meaning |
|------|---------|
| `0` | Passed (compliance ≥ threshold) |
| `1` | Failed (compliance < threshold or error) |

### `plumber generate config`

Generate a default `.plumber.yaml` configuration file.

```bash
plumber generate config [flags]
```

| Flag | Default | Description |
|------|---------|-------------|
| `--output`, `-o` | `.plumber.yaml` | Output file path |
| `--force`, `-f` | `false` | Overwrite existing file |

**Examples:**

```bash
# Generate default config
plumber generate config

# Custom filename
plumber generate config --output my-plumber.yaml

# Overwrite existing file
plumber generate config --force
```

## Usage Examples

### Save JSON Output

```bash
docker run --rm \
  -e GITLAB_TOKEN=glpat-xxxx \
  -v $(pwd):/output \
  getplumber/plumber:latest analyze \
  --gitlab-url https://gitlab.com \
  --project mygroup/myproject \
  --branch main \
  --config /.plumber.yaml \
  --threshold 100 \
  --output /output/results.json
```

### Self-Hosted GitLab

```bash
plumber analyze \
  --gitlab-url https://gitlab.example.com \
  --project mygroup/myproject \
  --branch develop \
  --config .plumber.yaml \
  --threshold 80
```

### Silent Mode (JSON Only)

```bash
plumber analyze \
  --gitlab-url https://gitlab.com \
  --project mygroup/myproject \
  --config .plumber.yaml \
  --threshold 100 \
  --output results.json \
  --print false
```

## Example Output

<Aside variant="tip">
  The CLI output is color-coded in your terminal for easy scanning - green for passing controls, red for failures.
</Aside>

![Plumber CLI output showing compliance results](./img/cli-output.png)

<Aside variant="tip">
  When using `--output`, results are saved as JSON for programmatic access and CI/CD integration.
</Aside>

## Configuration

Plumber uses a `.plumber.yaml` configuration file to customize checks. 

<Aside variant="tip">
   See the [Configuration](https://github.com/getplumber/plumber/blob/main/.plumber.yaml) section for full details.
</Aside>

```yaml
version: "1.0"

controls:
  imageMutable:
    enabled: true
    mutableTags:
      - latest
      - dev

  imageUntrusted:
    enabled: true
    trustDockerHubOfficialImages: true
    trustedUrls:
      - registry.gitlab.com/*
      - $CI_REGISTRY_IMAGE:*

  branchProtection:
    enabled: true
    defaultMustBeProtected: true
    namePatterns:
      - main
      - release/*
```

## Troubleshooting

| Issue | Solution |
|-------|----------|
| `GITLAB_TOKEN environment variable is required` | Set the `GITLAB_TOKEN` environment variable with a valid GitLab token |
| `401 Unauthorized` | Check that your token has `read_api` + `read_repository` scopes |
| `403 Forbidden` on MR settings | Expected on non-Premium GitLab; continues without that data |
| `404 Not Found` | Verify the project path and GitLab URL are correct |
| Configuration file not found | Ensure the path to `.plumber.yaml` is correct (use absolute path in Docker) |

<Aside variant="info">
  **Need help?** Open an issue on [GitHub](https://github.com/getplumber/plumber/issues) or join our [Discord](/discord).
</Aside>
