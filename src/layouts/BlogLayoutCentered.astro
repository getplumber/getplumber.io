---
import Button from "@components/Button/Button.astro";
import { getLocaleFromUrl } from "@js/localeUtils";
import { formatDate, humanize, slugify } from "@js/textUtils";
import { Image } from "astro:assets";
import { type CollectionEntry, getEntries } from "astro:content";

// main layout
import BaseLayout from "./BaseLayout.astro";

interface Props {
  post: CollectionEntry<"blog">;
  headings?: import("astro").MarkdownHeading[];
}

const { post } = Astro.props as Props;
const { title, description, authors, pubDate, updatedDate, heroImage } = post.data;

const currLocale = getLocaleFromUrl(Astro.url);
const authorsData = await getEntries(authors);
---

<BaseLayout
  type="blog"
  title={title}
  description={description}
  heroImage={heroImage}
  authorsData={authorsData}
  postFrontmatter={post.data}
>
  <article class="site-container mt-16 md:mt-28">
    <!-- article content -->
    <div class="mt-10 w-full">
      <div class="mx-auto max-w-2xl">
        <div class="text-base-content text-base">
          {
            updatedDate && (
              <div class="mb-6 italic">
                <time datetime={updatedDate.toISOString()}>
                  Updated: {formatDate(updatedDate, currLocale)}
                </time>
              </div>
            )
          }
          <section id="blog-post-content" class="markdown-content mx-auto md:text-lg">
            <slot />
          </section>

          <!-- button to go back to all posts -->
          <div class="mt-16 flex justify-center">
            <Button
              variant="outline"
              href={"/blog/"}
              arrow="left"
              class="py-2"
            >
              Back to all posts
            </Button>
          </div>
        </div>
      </div>
    </div>
  </article>
</BaseLayout>